(function(){"use strict";var e={5978:function(e,t,l){var o=l(9242),n=l(3396);function a(e,t,l,o,a,i){const s=(0,n.up)("HelloWorld");return(0,n.wg)(),(0,n.j4)(s)}var i=l(7139),s=l.p+"img/WEHI_logo.273fc6ad.png";const r=e=>((0,n.dD)("data-v-649195a0"),e=e(),(0,n.Cn)(),e),u={class:"hello"},d=r((()=>(0,n._)("img",{alt:"Vue logo",src:s},null,-1))),c=r((()=>(0,n._)("h1",null,"WEHI RCP Customised Platform",-1))),p=r((()=>(0,n._)("p",null,[(0,n.Uk)(" This page contains user-friendly workflows on some common image analyses. "),(0,n._)("br"),(0,n.Uk)(" Simply click the workflow that you would like to perform and upload images with the required format. "),(0,n._)("br"),(0,n._)("br"),(0,n.Uk)(" If you want to upload a job, please follow this format for the script. "),(0,n._)("br")],-1))),m={class:"workflow-selection"},f=r((()=>(0,n._)("option",{disabled:"",value:""},"Please select a workflow",-1))),g=r((()=>(0,n._)("option",{value:"workflow1"},"Normalize Histogram",-1))),_=r((()=>(0,n._)("option",{value:"workflow2"},"HDAB Counts",-1))),w=r((()=>(0,n._)("option",{value:"workflow3"},"[+ Customised job]",-1))),b=[f,g,_,w],h=r((()=>(0,n._)("br",null,null,-1))),k={key:0},y={key:1},v={key:2},j=r((()=>(0,n._)("strong",null,"Custom Python Script Instructions:",-1))),U=[j],C={key:3,class:"custom-instructions"},D=r((()=>(0,n._)("strong",null,"File Format:",-1))),I=r((()=>(0,n._)("code",null,".py",-1))),W=r((()=>(0,n._)("br",null,null,-1))),T=r((()=>(0,n._)("strong",null,"Main Function:",-1))),P=r((()=>(0,n._)("pre",{class:"code"},"def main(input_data):\n  # Your custom logic here\n  return result\n",-1))),x=r((()=>(0,n._)("code",null,"input_data:",-1))),H=r((()=>(0,n._)("br",null,null,-1))),S=r((()=>(0,n._)("code",null,"result:",-1))),N=r((()=>(0,n._)("pre",{class:"code"},'response_data = {\n    "Image": encoded_image,  # Base64-encoded grayscale image\n    "Data": computed_data if computed_data is not None else False  # Computed data, or False if no data is available\n}\n',-1))),z=r((()=>(0,n._)("strong",null,"Example Script:",-1))),A=r((()=>(0,n._)("pre",{class:"code"},'def main(input_image):\n    # Convert the input image to grayscale\n    grayscale_image = convert_to_grayscale(input_image)\n\n    # Encode the grayscale image as base64\n    encoded_image = base64_encode_image(grayscale_image)\n\n    # Prepare the response data\n    response_data = {\n        "image": encoded_image,\n        "data": False\n    }\n\n    return response_data\n',-1))),O=["accept"],E=r((()=>(0,n._)("label",{for:"fileUpload",class:"custom-file-upload"}," Click here to upload file ",-1))),F=r((()=>(0,n._)("br",null,null,-1))),L={key:0},B=r((()=>(0,n._)("label",{class:"custom-file-upload"}," Click here to upload your data ",-1))),G=r((()=>(0,n._)("br",null,null,-1))),J={class:"section-box submit-job-box"},M=r((()=>(0,n._)("h3",{class:"section-title"},"Job Scheduling",-1))),q=r((()=>(0,n._)("label",{for:"jobName"},"Job Name: ",-1))),R=r((()=>(0,n._)("br",null,null,-1))),V=r((()=>(0,n._)("label",{for:"jobTime"},"Job Time: ",-1))),Z=r((()=>(0,n._)("datalist",{id:"timeList"},[(0,n._)("option",null,"1"),(0,n._)("option",null,"2"),(0,n._)("option",null,"3"),(0,n._)("option",null,"4"),(0,n._)("option",null,"5"),(0,n._)("option",null,"6"),(0,n._)("option",null,"7")],-1))),$=r((()=>(0,n._)("br",null,null,-1))),Y=r((()=>(0,n._)("label",{for:"jobCPU"},"CPU Per Task: ",-1))),K=r((()=>(0,n._)("datalist",{id:"cpuList"},[(0,n._)("option",null,"1"),(0,n._)("option",null,"2"),(0,n._)("option",null,"3")],-1))),Q=r((()=>(0,n._)("br",null,null,-1))),X=r((()=>(0,n._)("label",{for:"jobNodes"},"Nodes: ",-1))),ee=r((()=>(0,n._)("datalist",{id:"nodeList"},[(0,n._)("option",null,"1"),(0,n._)("option",null,"2"),(0,n._)("option",null,"3")],-1))),te=r((()=>(0,n._)("br",null,null,-1))),le=r((()=>(0,n._)("label",{for:"jobP"},"Partition: ",-1))),oe=r((()=>(0,n._)("label",{for:"regular"},"Regular",-1))),ne=r((()=>(0,n._)("label",{for:"other"},"Other",-1))),ae=r((()=>(0,n._)("label",{for:"jobMem"},"Memory: ",-1))),ie=r((()=>(0,n._)("datalist",{id:"memList"},[(0,n._)("option",null,"1"),(0,n._)("option",null,"2"),(0,n._)("option",null,"3"),(0,n._)("option",null,"4"),(0,n._)("option",null,"5"),(0,n._)("option",null,"6"),(0,n._)("option",null,"7")],-1))),se=r((()=>(0,n._)("br",null,null,-1))),re=r((()=>(0,n._)("label",{for:"jobGRE"},"GREs: ",-1))),ue=r((()=>(0,n._)("datalist",{id:"greList"},[(0,n._)("option",null,"0"),(0,n._)("option",null,"1"),(0,n._)("option",null,"2"),(0,n._)("option",null,"3")],-1))),de=r((()=>(0,n._)("br",null,null,-1))),ce=r((()=>(0,n._)("br",null,null,-1))),pe={class:"section-box"},me=r((()=>(0,n._)("h3",{class:"section-title"},"Output",-1))),fe={class:"output-image-container"},ge={key:0,class:"loading-indicator"},_e={key:1,class:"image-wrapper"},we=["src"],be={key:2,class:"image-wrapper"},he=["src"],ke={key:3},ye=r((()=>(0,n._)("h3",null,"State Status",-1))),ve=r((()=>(0,n._)("br",null,null,-1))),je={key:4},Ue=r((()=>(0,n._)("h3",null,"Result Data",-1))),Ce={key:5},De=r((()=>(0,n._)("br",null,null,-1))),Ie=r((()=>(0,n._)("br",null,null,-1))),We={class:"section-box jobs-box"},Te=r((()=>(0,n._)("h3",{class:"section-title"},"Jobs",-1))),Pe={key:0},xe=r((()=>(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"Job ID"),(0,n._)("th",null,"Partition"),(0,n._)("th",null,"Name"),(0,n._)("th",null,"User"),(0,n._)("th",null,"Status"),(0,n._)("th",null,"Memory"),(0,n._)("th",null,"Time"),(0,n._)("th",null,"Nodes")])],-1))),He=(0,n.uE)('<h3 data-v-649195a0>References</h3><ul data-v-649195a0><li data-v-649195a0><a href="https://training.galaxyproject.org/training-material/topics/imaging/tutorials/imaging-introduction/tutorial.html" target="_blank" rel="noopener" data-v-649195a0>galaxy-tutorial</a></li><li data-v-649195a0><a href="https://bioblend.readthedocs.io/en/latest/" target="_blank" rel="noopener" data-v-649195a0>bioblend</a></li></ul><h3 data-v-649195a0>Directories</h3><ul data-v-649195a0><li data-v-649195a0><a href="https://github.com/WEHI-ResearchComputing" target="_blank" rel="noopener" data-v-649195a0>WEHI-Research-Computing</a></li><li data-v-649195a0><a href="https://github.com/WEHI-ResearchComputing/Imaging-Getting-Started" target="_blank" rel="noopener" data-v-649195a0>Imaging-Project</a></li><li data-v-649195a0><a href="https://github.com/WEHI-ResearchComputing/Imaging-Getting-Started/wiki/Technical-Notes" target="_blank" rel="noopener" data-v-649195a0>Technical-Notes</a></li><li data-v-649195a0><a href="https://github.com/WEHI-ResearchComputing/Imaging-Getting-Started/wiki/High%E2%80%90level-Architecture" target="_blank" rel="noopener" data-v-649195a0>Architecture</a></li></ul>',4);function Se(e,t,l,a,s,r){return(0,n.wg)(),(0,n.iD)("div",u,[d,c,(0,n._)("h1",null,(0,i.zw)(l.msg),1),p,(0,n._)("div",m,[(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedWorkflow=e)},b,512),[[o.bM,s.selectedWorkflow]])]),h,(0,n._)("div",null,["workflow1"===s.selectedWorkflow?((0,n.wg)(),(0,n.iD)("p",k,"Input must be images (jpeg, png, tiff). ")):(0,n.kq)("",!0),"workflow2"===s.selectedWorkflow?((0,n.wg)(),(0,n.iD)("p",y,"Input must be images (jpeg, png, tiff). ")):(0,n.kq)("",!0),"workflow3"===s.selectedWorkflow?((0,n.wg)(),(0,n.iD)("p",v,U)):(0,n.kq)("",!0),"workflow3"===s.selectedWorkflow?((0,n.wg)(),(0,n.iD)("ol",C,[D,(0,n.Uk)(" Save your custom script as a "),I,(0,n.Uk)(" file. "),W,T,(0,n.Uk)(" Your script should include a main function with the following signature: "),P,x,(0,n.Uk)(" This parameter should accept the input data required for your script's execution. "),H,S,(0,n.Uk)(" The main function should return the result of the computation in this format: "),N,z,(0,n.Uk)(" Here's a simple example script that you can use as a template: "),A])):(0,n.kq)("",!0)]),(0,n._)("div",null,[(0,n._)("input",{type:"file",id:"fileUpload",onChange:t[1]||(t[1]=(...e)=>r.handleFiles&&r.handleFiles(...e)),accept:r.getAcceptAttribute,style:{display:"none"}},null,40,O),E]),F,"workflow3"===s.selectedWorkflow?((0,n.wg)(),(0,n.iD)("div",L,[(0,n._)("div",null,[(0,n._)("input",{type:"file",onChange:t[2]||(t[2]=(...e)=>r.handleCustomInput&&r.handleCustomInput(...e)),style:{display:"none"}},null,32),B])])):(0,n.kq)("",!0),G,(0,n._)("div",J,[M,q,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.jobName=e),type:"text",id:"jobName"},null,512),[[o.nr,s.jobName]]),R,V,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.jobTime=e),type:"range",min:"1",max:"7",step:"1",id:"jobTime",list:"timeList"},null,512),[[o.nr,s.jobTime]]),(0,n._)("span",null,(0,i.zw)(s.jobTime)+" hours",1),Z,$,Y,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>s.jobCPU=e),type:"range",min:"1",max:"3",step:"1",id:"jobCPU",list:"cpuList"},null,512),[[o.nr,s.jobCPU]]),(0,n._)("span",null,(0,i.zw)(s.jobCPU),1),K,Q,X,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>s.jobNodes=e),type:"range",min:"1",max:"3",step:"1",id:"jobNodes",list:"nodeList"},null,512),[[o.nr,s.jobNodes]]),(0,n._)("span",null,(0,i.zw)(s.jobNodes),1),ee,te,le,(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{type:"radio",id:"regular","onUpdate:modelValue":t[7]||(t[7]=e=>s.jobP=e),value:"regular"},null,512),[[o.G2,s.jobP]]),oe,(0,n.wy)((0,n._)("input",{type:"radio",id:"other","onUpdate:modelValue":t[8]||(t[8]=e=>s.jobP=e),value:"other"},null,512),[[o.G2,s.jobP]]),ne]),ae,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>s.jobMem=e),type:"range",min:"1",max:"7",step:"1",id:"jobMem",list:"memList"},null,512),[[o.nr,s.jobMem]]),(0,n._)("span",null,(0,i.zw)(s.jobMem)+" GB",1),ie,se,re,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>s.jobGre=e),type:"range",min:"0",max:"3",step:"1",id:"jobGre",list:"greList"},null,512),[[o.nr,s.jobGre]]),(0,n._)("span",null,(0,i.zw)(s.jobGre),1),ue,de]),(0,n._)("button",{onClick:t[11]||(t[11]=(...e)=>r.executeWorkflow&&r.executeWorkflow(...e)),class:"execute-button"},"Execute Workflow"),ce,(0,n._)("div",pe,[me,(0,n._)("div",fe,[s.isLoading?((0,n.wg)(),(0,n.iD)("h4",ge," Loading... ")):s.wf1convertedImageUrl?((0,n.wg)(),(0,n.iD)("div",_e,[(0,n._)("img",{src:s.wf1convertedImageUrl,alt:"Output Image",class:"output-image"},null,8,we)])):s.resultImage?((0,n.wg)(),(0,n.iD)("div",be,[(0,n._)("img",{src:s.resultImage,alt:"Output Image",class:"output-image"},null,8,he)])):(0,n.kq)("",!0),s.wf1stateTimes&&Object.keys(s.wf1stateTimes).length>0?((0,n.wg)(),(0,n.iD)("div",ke,[ye,(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.wf1stateTimes,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},[(0,n.Uk)((0,i.zw)(t)+": "+(0,i.zw)(e)+" seconds",1),ve])))),128))])])):(0,n.kq)("",!0),s.resultData?((0,n.wg)(),(0,n.iD)("div",je,[Ue,(0,n.Uk)(" "+(0,i.zw)(s.resultData),1)])):(0,n.kq)("",!0),null!==s.wf2Hcount&&null!==s.wf2DABcount?((0,n.wg)(),(0,n.iD)("div",Ce,[(0,n._)("p",null,"Hcount: "+(0,i.zw)(s.wf2Hcount),1),(0,n._)("p",null,"DABcount: "+(0,i.zw)(s.wf2DABcount),1)])):(0,n.kq)("",!0)])]),De,(0,n._)("button",{onClick:t[12]||(t[12]=(...e)=>r.viewJobs&&r.viewJobs(...e)),class:"view-jobs-button"},"View Jobs"),Ie,(0,n._)("div",We,[Te,s.displayJobs?((0,n.wg)(),(0,n.iD)("table",Pe,[xe,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.jobStatus,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.job_id},[(0,n._)("td",null,(0,i.zw)(e.job_id),1),(0,n._)("td",null,(0,i.zw)(e.partition),1),(0,n._)("td",null,(0,i.zw)(e.name),1),(0,n._)("td",null,(0,i.zw)(e.user),1),(0,n._)("td",null,(0,i.zw)(e.status),1),(0,n._)("td",null,(0,i.zw)(e.memory),1),(0,n._)("td",null,(0,i.zw)(e.time),1),(0,n._)("td",null,(0,i.zw)(e.nodes),1)])))),128))])])):(0,n.kq)("",!0)]),He])}var Ne=l(4161),ze=l(8291),Ae={name:"HelloWorld",props:{msg:String},data(){return{selectedWorkflow:"",isLoading:!1,uploadedFiles:null,customInputs:null,wf1stateTimes:null,wf1imageUrl:null,wf1convertedImageUrl:null,wf2Hcount:null,wf2DABcount:null,jobStatus:[],displayJobs:!1,resultImage:!1,resultData:!1,jobTime:5,jobCPU:1,jobNodes:1,jobP:"regular",jobMem:1,jobGre:0,jobName:"my-job"}},computed:{getAcceptAttribute(){return"workflow1"===this.selectedWorkflow||"workflow2"===this.selectedWorkflow?"image/jpeg, image/png, image/tiff":"workflow3"===this.selectedWorkflow?".py":""}},methods:{handleFiles(e){this.uploadedFiles=e.target.files},handleCustomInput(e){this.customInputs=e.target.files},async executeWorkflow(){if(!this.selectedWorkflow||!this.uploadedFiles)return void alert("Please select a workflow and upload files");const e=new FormData,t=`#!/bin/bash\n#SBATCH --job-name=${this.jobName}\n#SBATCH --time=0${this.jobTime}:00:00\n#SBATCH --ntasks=${this.jobNodes}\n#SBATCH --mem=${this.jobMem}G\n#SBATCH cpus-per-task=${this.jobCPU}\n`;e.append("script",t);for(let o=0;o<this.uploadedFiles.length;o++)e.append("files",this.uploadedFiles[o]);if(e.append("workflow",this.selectedWorkflow),"workflow3"==this.selectedWorkflow&&this.customInputs)for(let o=0;o<this.customInputs.length;o++)e.append("inputs",this.customInputs);else e.append("inputs",1);this.isLoading=!0;try{const t=await Ne.Z.post("http://127.0.0.1:5000/response",e);if(this.isLoading=!1,console.log(t.data),"workflow1"==this.selectedWorkflow){this.wf1stateTimes=t.data.state_times,console.log(this.wf1stateTimes),this.wf1imageUrl=t.data.output_path,console.log(this.wf1imageUrl);const e=await ze.ZP.load(this.wf1imageUrl),l=await e.toDataURL("image/png");this.wf1convertedImageUrl=l}"workflow2"==this.selectedWorkflow&&(this.wf2Hcount=t.data.Hcount,this.wf2DABcount=t.data.DABcount,console.log(this.wf2Hcount),console.log(this.wf2DABcount)),"workflow3"==this.selectedWorkflow&&(this.resultImage=t.data.image,this.resultData=t.data.data)}catch(l){console.error("Error uploading files:",l)}},async viewJobs(){await this.fetchJobStatus(),this.displayJobs=!0},async fetchJobStatus(){try{const e=await Ne.Z.get("http://127.0.0.1:5000/squeue");this.jobStatus=e.data}catch(e){console.error("Error fetching job status:",e)}}}},Oe=l(89);const Ee=(0,Oe.Z)(Ae,[["render",Se],["__scopeId","data-v-649195a0"]]);var Fe=Ee,Le={name:"App",components:{HelloWorld:Fe}};const Be=(0,Oe.Z)(Le,[["render",a]]);var Ge=Be;(0,o.ri)(Ge).mount("#app")}},t={};function l(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,l),a.exports}l.m=e,function(){var e=[];l.O=function(t,o,n,a){if(!o){var i=1/0;for(d=0;d<e.length;d++){o=e[d][0],n=e[d][1],a=e[d][2];for(var s=!0,r=0;r<o.length;r++)(!1&a||i>=a)&&Object.keys(l.O).every((function(e){return l.O[e](o[r])}))?o.splice(r--,1):(s=!1,a<i&&(i=a));if(s){e.splice(d--,1);var u=n();void 0!==u&&(t=u)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,n,a]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){l.p="/"}(),function(){var e={143:0};l.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,a,i=o[0],s=o[1],r=o[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(n in s)l.o(s,n)&&(l.m[n]=s[n]);if(r)var d=r(l)}for(t&&t(o);u<i.length;u++)a=i[u],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return l.O(d)},o=self["webpackChunkgalaxy_web"]=self["webpackChunkgalaxy_web"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=l.O(void 0,[998],(function(){return l(5978)}));o=l.O(o)})();
//# sourceMappingURL=app.7ba5516c.js.map